{% extends "menu_base.html" %}
{% load url from future %}
{% load verbatim %}

{% block title %}Tech Residents Chat{% endblock %}

{% block extrahead %}
<link href="{{STATIC_URL}}css/chat.css" rel="stylesheet">

<style type="text/css">
    {% for user in users %}
    .user{{user.id}} {
        color: {% cycle '#00A651' '#00AEEF' '#F15A29' '#231F20' as usercolor %};
    }
    
    .user{{user.id}}-border {
        border-style: solid;
        border-color: {{ usercolor }};
        border-width: 5px;
    }
    {% endfor %}
</style>

<script src="http://staging.tokbox.com/v0.91/js/TB.min.js" ></script>

<script>
    var require = {
        baseUrl: '/static/js',
    };
</script>
<script data-main="{{STATIC_URL}}js/apps/chat/main.js" src="{{STATIC_URL}}js/3ps/require/require.js"></script>
{% endblock %}

{% block content %}

<div class="container" id="chatapp">
    <div class="row" id="chat"></div>
    <div class="row">
        <div id="discuss"class="span12 page-header">
        </div>
    </div>
    <div class="row">
        <div id="tagger" class="span12 page-header">
        </div>
    </div>
    <div class="row">
    </div>
    <div class="row">
        <div class="span12">
            <ul class="nav nav-tabs">
                <li class="active" ><a data-toggle="tab" href="#agenda">Agenda</a></li>
                <li><a data-toggle="tab" href="#whiteboard">Whiteboard</a></li>
                <li><a data-toggle="tab" href="#resources">Resources</a></li>
            </ul>
            <div class="tab-content">
                <div id="agenda" class="tab-pane fade in active">
                </div>
                <div id="whiteboard" class="tab-pane fade">
                    <div id="whiteboard-tools"></div>
                    <div id="whiteboard-controls"></div>
                    <div id="whiteboard-containerZ"></div>
                </div>
                <div id="resources" class="tab-pane fade">
                </div>
            </div>
        </div>
    </div>
</div>


<!-- All of these data structures are generated on the server w/out user input, so it's safe -->
{% autoescape off %}
<script>
    TR = { XD: { remote: "{{TR_XD_REMOTE}}" } };

    data =  {
        chatAPIKey: "{{chat_api_key}}",
        chatSessionToken: "{{chat_session_token}}",
        chatUserToken: "{{chat_user_token}}",
        users: {{users_json}},
        topics: {{topics_json}},
        resources: {{resources_json}},
    };
</script>
{% endautoescape %}

<!-- Templates -->

    <script type="text/template" id="whiteboard-tools-template">
    <div class="span2">
        <div class="well">
            <ul class="nav nav-list">
                <li class="nav-header">Tools</li>
                <li><a href="#" id="tools-pen">Pen</a></li>
                <li><a href="#" id="tools-arrow">Arrow</a></li>
                <li><a href="#" id="tools-rect">Rectangle</a></li>
                <li><a href="#" id="tools-circle">Circle</a></li>
                <li><a href="#" id="tools-text">Text</a></li>
                <li><a href="#">Erase</a></li>
                <li><a href="#">Color Picker</a></li>
            </ul>
        </div>
    </div>
 </script>

<script type="text/template" id="whiteboard-controls-template">
    <div class="span9">
        <div id="nav-panel-whiteboard">
            <select id="select-whiteboard">
                <%_.each(whiteboardCollection, function(whiteboard) { %>
                    <option value="<%= whiteboard.whiteboardId %>"><%= whiteboard.name %></option>
                <% }); %>
            </select>
            <button class="btn btn-input" data-toggle="modal" href="#create-whiteboard-modal">Create</button>
            <button id="whiteboard-delete-button" class="btn btn-input">Delete</button>
            <button id="whiteboard-clear-button" class="btn btn-input">Clear</button>

            <div class="modal hide fade" id="create-whiteboard-modal">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal">Ã—</button>
                    <h3>Whiteboard Name</h3>
                </div>
                <div class="modal-body">
                    <div id="create-whiteboard-name-input">
                        <input type="text" class="input-xlarge" id="whiteboard-name-input">
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="#" class="btn" data-dismiss="modal">Close</a>
                    <a href="#" id="whiteboard-add-button" class="btn btn-primary">OK</a>
                </div>
            </div>

        </div>
    </div>
</script>

<script type="text/template" id="whiteboard-container-template">
    <div class="span9">
        <div class="well" id="whiteboard-wrapper">

        </div>
    </div>
</script>

<script type="text/template" id="whiteboard-text-input-template">
    <input class="span1 whiteboard-text-input" type="text" name="wb-text-input" />
</script>

{% endblock %}
