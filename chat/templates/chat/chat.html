{% extends "menu_base.html" %}
{% load url from future %}
{% load verbatim %}

{% block title %}Tech Residents Chat{% endblock %}

{% block extrahead %}
<link href="{{STATIC_URL}}css/chat.css" rel="stylesheet">

<script src="http://staging.tokbox.com/v0.91/js/TB.min.js" ></script>

<script>
    var require = {
        baseUrl: '/static/js',
    };
</script>
<script data-main="{{STATIC_URL}}js/apps/chat/main.js" src="{{STATIC_URL}}js/3ps/require/require.js"></script>
{%endblock %}

{% block content %}

<div class="container" id="chatapp">
    <div class="row" id="chat"></div>
    <div class="row">
        <div class="span12 page-header">
            <h3>Discuss: Web Security: Preventitive Measures</h3>
        </div>
    </div>
    <div class="row">
    </div>
    <div class="row">
        <div class="span12">
            <ul class="nav nav-tabs">
                <li class="active"><a data-toggle="tab" href="#home">Home</a></li>
                <li><a data-toggle="tab" href="#whiteboard-container">Whiteboard</a></li>
            </ul>
            <div class="tab-content">
                <div id="home" class="tab-pane fade in active">
                    <div class="span5">
                        <h5>Agenda</h5>
                        <div>
                            <ul id="topiclist" class="chatlist">
                            </ul>
                        </div>
                    </div>
                    <div class="span5">
                        <h5>Tags</h5>
                        <div id="tags">
                            <ul id="taglist"class="chatlist">
                            </ul>
                            
                            <input id="taginput" class="span4"/>
                            <button class="btn btn-input">Tag</button>
                        </div>
                    </div>
                </div>
                <div id="whiteboard-container" class="span10 well tab-pane fade">
                    <div id="whiteboard" class="span10">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- All of these data structures are generated on the server w/out user input, so it's safe -->
{% autoescape off %}
<script>
    TR = { XD: { remote: "{{TR_XD_REMOTE}}" } };

    data =  {
        chatAPIKey: "{{chat_api_key}}",
        chatSessionToken: "{{chat_session_token}}",
        chatUserToken: "{{chat_user_token}}",
        users: {{users_json}} };
</script>
{% endautoescape %}

<!-- Templates -->

<script type="text/template" id="chat-user-header-template">
    <div id="user<%= id %>-header">
    </div>
</script>

<script type="text/template" id="chat-user-template">
    <div class="well chat-user-container">
        <div id="user<%= id %>">
            <img height=200 src="{{STATIC_URL}}img/person.jpg"/>
        </div>
    </div>
</script>

<script type="text/template" id="chat-user-footer-template">
    <div id="user<%= id %>-footer"
        <p>Connected: <%= isConnected %> </p>
        <p>Publishing: <%= isPublishing %> </p>
    <div/>
</script>

<script type="text/template" id="tag-item-template">
    <%= name %>
</script>


{% endblock %}
